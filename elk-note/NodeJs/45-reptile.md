
## çˆ¬è™«ä»‹ç»

çˆ¬è™«ï¼Œä¹Ÿç§°ä¸ºç½‘ç»œçˆ¬è™«æˆ–ç½‘ç»œèœ˜è››ï¼Œæ˜¯æŒ‡ä¸€ç§è‡ªåŠ¨åŒ–ç¨‹åºæˆ–è„šæœ¬ï¼Œç”¨äºåœ¨äº’è”ç½‘ä¸Šæµè§ˆå’Œæå–ä¿¡æ¯ã€‚çˆ¬è™«æ¨¡æ‹Ÿäººç±»ç”¨æˆ·åœ¨ç½‘é¡µä¸Šçš„è¡Œä¸ºï¼Œé€šè¿‡HTTPåè®®å‘é€è¯·æ±‚ï¼Œè·å–ç½‘é¡µå†…å®¹ï¼Œç„¶åè§£æå¹¶æå–æ„Ÿå…´è¶£çš„æ•°æ®

> åœ¨ä½¿ç”¨çˆ¬è™«æ—¶ï¼Œéœ€è¦éµå®ˆæ³•å¾‹æ³•è§„å’Œç½‘ç«™çš„ä½¿ç”¨æ¡æ¬¾

- ç½‘ç«™çš„ä½¿ç”¨æ¡æ¬¾ï¼šæ¯ä¸ªç½‘ç«™éƒ½æœ‰è‡ªå·±çš„ä½¿ç”¨æ¡æ¬¾å’Œéšç§æ”¿ç­–ï¼Œè¿™äº›è§„å®šäº†å¯¹ç½‘ç«™å†…å®¹å’Œæ•°æ®çš„è®¿é—®å’Œä½¿ç”¨é™åˆ¶ã€‚åœ¨ä½¿ç”¨çˆ¬è™«ä¹‹å‰ï¼ŒåŠ¡å¿…ä»”ç»†é˜…è¯»å¹¶éµå®ˆç½‘ç«™çš„ä½¿ç”¨æ¡æ¬¾ã€‚
- çŸ¥è¯†äº§æƒï¼šçˆ¬è™«å¯èƒ½æ¶‰åŠåˆ°å¯¹ç½‘ç«™ä¸Šçš„å†…å®¹è¿›è¡Œå¤åˆ¶ã€æå–æˆ–åˆ†å‘ã€‚åœ¨è¿›è¡Œè¿™äº›æ“ä½œæ—¶ï¼Œä½ åº”è¯¥å°Šé‡çŸ¥è¯†äº§æƒæ³•å¾‹ï¼ŒåŒ…æ‹¬ç‰ˆæƒå’Œå•†æ ‡æ³•ã€‚ç¡®ä¿ä½ æœ‰åˆæ³•çš„æƒåˆ©ä½¿ç”¨ã€å¤åˆ¶æˆ–åˆ†å‘æ‰€çˆ¬å–çš„å†…å®¹ã€‚
- ç½‘ç»œç ´åå’Œæ»¥ç”¨ï¼šä½¿ç”¨çˆ¬è™«æ—¶ï¼Œåº”é¿å…å¯¹ç›®æ ‡ç½‘ç«™é€ æˆä¸å¿…è¦çš„è´Ÿè½½ã€å¹²æ‰°æˆ–ç ´åã€‚ä¸å¾—ä»¥æ¶æ„æ–¹å¼ä½¿ç”¨çˆ¬è™«ï¼Œå¦‚è¿›è¡ŒDDoSæ”»å‡»ã€ç ´è§£å®‰å…¨æªæ–½æˆ–éæ³•æœé›†ä¸ªäººä¿¡æ¯ã€‚
- æ•°æ®éšç§å’Œä¸ªäººä¿¡æ¯ä¿æŠ¤ï¼šåœ¨çˆ¬å–ç½‘ç«™ä¸Šçš„æ•°æ®æ—¶ï¼Œéœ€ç‰¹åˆ«æ³¨æ„å¤„ç†ä¸ªäººèº«ä»½ä¿¡æ¯å’Œéšç§æ•°æ®çš„åˆè§„æ€§ã€‚éµå®ˆé€‚ç”¨çš„æ•°æ®ä¿æŠ¤æ³•å¾‹ï¼Œç¡®ä¿åˆæ³•åœ°å¤„ç†å’Œå­˜å‚¨ç”¨æˆ·æ•°æ®ã€‚
- æ¬ºè¯ˆå’Œæ»¥ç”¨ï¼šä¸å¾—ä½¿ç”¨çˆ¬è™«è¿›è¡Œæ¬ºè¯ˆã€ä»¿å†’ã€åƒåœ¾é‚®ä»¶æˆ–å…¶ä»–éæ³•æ´»åŠ¨ã€‚å°Šé‡å…¶ä»–ç”¨æˆ·å’Œç½‘ç«™çš„åˆ©ç›Šï¼Œéµå®ˆå…¬å¹³ç«äº‰åŸåˆ™

[æ˜é‡‘è§„åˆ™](https://juejin.cn/robots.txt)

## ä¾èµ–å®‰è£…

### Puppeteer
Puppeteeræ˜¯ä¸€ä¸ªNodeåº“ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé«˜çº§APIæ¥é€šè¿‡DevToolsåè®®æ§åˆ¶Chromiumæˆ–Chromeã€‚Puppeteeré»˜è®¤ä»¥headlessæ¨¡å¼è¿è¡Œï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶è¿è¡Œâ€œæœ‰å¤´â€æ¨¡å¼ã€‚æ‚¨å¯ä»¥ä½¿ç”¨Puppeteerå®Œæˆç»å¤§å¤šæ•°åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨æ‰§è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚ç”Ÿæˆé¡µé¢PDFã€æŠ“å–SPAï¼ˆå•é¡µåº”ç”¨ï¼‰å¹¶ç”Ÿæˆé¢„æ¸²æŸ“å†…å®¹ã€è‡ªåŠ¨æäº¤è¡¨å•ã€è¿›è¡ŒUIæµ‹è¯•ã€é”®ç›˜è¾“å…¥ç­‰
```shell
npm install puppeteer
```
### python
ä½¿ç”¨pythonè„šæœ¬è¿›è¡Œåˆ†è¯å’Œç”Ÿæˆè¯äº‘å›¾
#### wordcloud
WordCloudæ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆè¯äº‘çš„Pythonåº“ã€‚å®ƒå¯ä»¥æ ¹æ®ç»™å®šçš„æ–‡æœ¬æ•°æ®ï¼Œæ ¹æ®è¯é¢‘ç”Ÿæˆä¸€ä¸ªç¾è§‚çš„è¯äº‘å›¾åƒï¼Œå…¶ä¸­è¯è¯­çš„å¤§å°è¡¨ç¤ºå…¶åœ¨æ–‡æœ¬ä¸­çš„é‡è¦ç¨‹åº¦æˆ–é¢‘ç‡ã€‚WordCloudåº“æä¾›äº†ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥æ§åˆ¶è¯äº‘çš„å¤–è§‚ã€é¢œè‰²ã€å­—ä½“ç­‰å±æ€§ã€‚ä½ å¯ä»¥æ ¹æ®éœ€æ±‚å®šåˆ¶è¯äº‘çš„æ ·å¼å’Œå¸ƒå±€ã€‚WordCloudè¿˜æä¾›äº†ä¸€äº›æ–¹ä¾¿çš„æ–¹æ³•ï¼Œç”¨äºä»æ–‡æœ¬ä¸­æå–å…³é”®è¯ã€è¿‡æ»¤åœç”¨è¯ç­‰ã€‚ä½ å¯ä»¥ä½¿ç”¨pipå®‰è£…WordCloudåº“ï¼Œå¹¶å‚è€ƒå®˜æ–¹æ–‡æ¡£è¿›è¡Œä½¿ç”¨ã€‚
```shell
pip install wordcloud #ç”Ÿæˆè¯äº‘å›¾
```
#### jieba
jiebaæ˜¯ä¸€ä¸ªå¼€æºçš„ä¸­æ–‡åˆ†è¯åº“ï¼Œç”¨äºå°†ä¸­æ–‡æ–‡æœ¬åˆ‡åˆ†æˆå•ä¸ªè¯è¯­ã€‚ä¸­æ–‡åˆ†è¯æ˜¯NLPï¼ˆè‡ªç„¶è¯­è¨€å¤„ç†ï¼‰ä¸­çš„ä¸€ä¸ªé‡è¦ä»»åŠ¡ï¼Œjiebaåº“æä¾›äº†ä¸€ç§æœ‰æ•ˆä¸”çµæ´»çš„åˆ†è¯ç®—æ³•ï¼Œå¯ä»¥åœ¨ä¸­æ–‡æ–‡æœ¬ä¸­å‡†ç¡®åœ°è¯†åˆ«å‡ºè¯è¯­è¾¹ç•Œã€‚jiebaæ”¯æŒä¸‰ç§åˆ†è¯æ¨¡å¼ï¼šç²¾ç¡®æ¨¡å¼ã€å…¨æ¨¡å¼å’Œæœç´¢å¼•æ“æ¨¡å¼ã€‚ä½ å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©é€‚åˆçš„åˆ†è¯æ¨¡å¼
```shell
pip install jieba #ä¸­æ–‡åˆ†è¯
```
## è„šæœ¬ç¼–å†™

### index.js
Nodeç«¯ä»£ç ç¼–å†™
```javascript
import puppeteer from "puppeteer";
import { spawn } from 'child_process';

// è·å–æ‰§è¡Œå‘½ä»¤åè¾“å…¥çš„å…³é”®å­—
const btnText = process.argv[2];

// å…³é—­æ— å¤´æ¨¡å¼
const browser = await puppeteer.launch({headless: false});

// æ‰“å¼€æµè§ˆå™¨
const page = await browser.newPage();

// è®¾ç½®æµè§ˆå™¨çª—å£å†…å®¹å¤§å°
page.setViewport({width: 1980, height: 1000});

// è·³è½¬åˆ°æ˜é‡‘çš„é¦–é¡µ
await page.goto("https://juejin.cn/");

// ç­‰å¾…å·¦ä¾§å¯¼èˆªæ åŠ è½½å®Œæ¯•åå†è·å–
await page.waitForSelector('.side-navigator-wrap')

// è·å–å·¦ä¾§å¯¼èˆªæ çš„æ ‡é¢˜å…ƒç´ 
const elements = await page.$$('.side-navigator-wrap .nav-item-wrap span');

/*
*  è·å–å·¦ä¾§å¯¼èˆªæ å¯¹åº”çš„æ¨èåˆ—è¡¨å†…å®¹
* */
// å­˜å‚¨æ¨èåˆ—è¡¨å†…å®¹
const contentList = []
const collectFn = async () => {
    // ç­‰å¾…æ¨èå†…å®¹åŠ è½½å®Œå†è·å–
    await page.waitForSelector('.entry-list')
    // è·å–æ¨èå†…å®¹æ ‡é¢˜å…ƒç´ 
    const contents = await page.$$('.entry-list .title-row a');
    // éå†æ¨èå†…å®¹æ ‡é¢˜å…ƒç´ ï¼Œå¾—åˆ°æ ‡é¢˜å…ƒç´ ä¸­çš„å†…å®¹
    for await (let el of contents) {
        const text = await el.getProperty("innerText") // è·å–elçš„å±æ€§
        const name = await text.jsonValue() // è·å–spanä¸­çš„å†…å®¹
        contentList.push(name) // å°†å¾—åˆ°çš„æ ‡é¢˜å†…å®¹ï¼Œpushåˆ°æ•°ç»„é›†åˆä¸­
    }
    console.log("ğŸš€ ~ forawait ~ contentList:", contentList) // æ‰“å°æµ‹è¯•ä¸€ä¸‹
    // åˆ›å»ºå­è¿›ç¨‹ï¼Œè°ƒç”¨phthonè„šæœ¬ï¼Œä¼ é€’æ ‡é¢˜å‚æ•°ï¼Œç”Ÿæˆè¯äº‘å›¾
    const pythonProcess = spawn("python3",["index.py", contentList.join(",")])
    // ç›‘å¬å­è¿›ç¨‹çš„è¾“å‡º
    pythonProcess.stdout.on("data", (data) => {
        console.log("è¾“å‡ºdata", data)
    })
    // ç›‘å¬å­è¿›ç¨‹çš„é”™è¯¯è¾“å‡º
    pythonProcess.stderr.on("data", (err) => {
        console.log("è¾“å‡ºé”™è¯¯", err);
    })
    // ç›‘å¬å­è¿›ç¨‹çš„å–æ¶ˆ
    pythonProcess.on("close", (code) => {
        console.log("æ˜¯å¦å–æ¶ˆ", code)
    })
}

// å¾ªç¯éå†æ ‡é¢˜å…ƒç´ ï¼Œå¾—åˆ°å†…å®¹
for await (let el of elements) {
    const text = await el.getProperty("innerText") // è·å–elçš„å±æ€§
    const name = await text.jsonValue() // è·å–spanä¸­çš„å†…å®¹
    if(name.trim() === ( btnText || 'å‰ç«¯' )) {
        el.click(); // è§¦å‘ç‚¹å‡»å¯¹åº”çš„èœå•
        collectFn(); // è°ƒç”¨æ–¹æ³•è·å–æ¨èå†…å®¹
    }
}
```
### index.py
ç¼–å†™æ‰§è¡Œpythonè„šæœ¬çš„å†…å®¹ï¼Œç”Ÿæˆè¯äº‘å›¾
```python
import jieba #å¼•å…¥ç»“å·´åº“
from wordcloud import WordCloud #å¼•å…¥è¯äº‘åº“
import matplotlib.pyplot as plt
import sys

# æ¥æ”¶nodeä¼ é€’çš„å‚æ•°
text = sys.argv[1]
# è¿›è¡Œåˆ†è¯
words = jieba.cut(text);
# å¼•å…¥æ‰§è¡Œçš„ä¸­æ–‡å­—ä½“
font = './font.ttf';
# wordcloudæœ¬èº«ä¸æ”¯æŒä¸­æ–‡ï¼Œéœ€æŒ‡å®šä¸­æ–‡å­—ä½“
wc = WordCloud( font_path = font, width=1000, height=800, background_color+='white' );
wc.generate( ' '.join(words) )

# è¾“å‡ºè¯äº‘å›¾
plt.imshow(wc,interpolation='bilinear')
plt.axis('off')
plt.show() # ç›´æ¥æ‰“å¼€å›¾ç‰‡
# plt.savefig('wordcloud.png', format='png')
# plt.close()  # å…³é—­pltï¼Œé¿å…å†…å­˜æ³„æ¼
```
